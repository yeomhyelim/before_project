-- 테이블 생성 --
CREATE TABLE `POST_MAIL` (
						  `PM_NO` BIGINT NOT NULL AUTO_INCREMENT COMMENT '번호',
						  `PM_TITLE` VARCHAR(500) COMMENT '제목',
						  `PM_TEXT` TEXT COMMENT '내용',
						  `PM_TOTAL_CNT` BIGINT COMMENT '발송건수',
						  `PM_REG_DT` DATETIME COMMENT '작성일',
						  `PM_REG_NO` BIGINT COMMENT '작성자',
						  `PM_MOD_DT` DATETIME COMMENT '수정일',
						  `PM_MOD_NO` BIGINT COMMENT '수정자',
						  PRIMARY KEY(PM_NO)
						) ENGINE=MyISAM
						COMMENT='전체메일발송관리';




-- 프로시저 --
CREATE PROCEDURE SP_POST_MAIL_I (
	 IN IN_PM_TITLE VARCHAR(500)
	,IN IN_PM_TEXT BLOB
	,IN IN_PM_REG_NO INT
	,IN IN_PM_MOD_NO INT
)
BEGIN
	INSERT INTO POST_MAIL (
		 PM_TITLE
		,PM_TEXT
		,PM_TOTAL_CNT
		,PM_REG_DT
		,PM_REG_NO
		,PM_MOD_DT
		,PM_MOD_NO
	) VALUES (
		 IN_PM_TITLE
		,IN_PM_TEXT
		,0
		,NOW()
		,IN_PM_REG_NO
		,NOW()
		,IN_PM_MOD_NO
	);
END;

CREATE PROCEDURE SP_POST_MAIL_U (
	 IN IN_PM_NO INT
	,IN IN_PM_TITLE VARCHAR(500)
	,IN IN_PM_TEXT BLOB
	,IN IN_PM_MOD_NO INT
)
BEGIN
	UPDATE POST_MAIL SET 
		PM_TITLE = IN_PM_TITLE
		,PM_TEXT = IN_PM_TEXT
		,PM_MOD_DT = NOW()
		,PM_MOD_NO = IN_PM_MOD_NO
	WHERE PM_NO = IN_PM_NO;
END;

CREATE PROCEDURE SP_POST_MAIL_D (
	 IN IN_PM_NO INT
)
BEGIN
	DELETE FROM POST_MAIL
	WHERE PM_NO = IN_PM_NO;
END;