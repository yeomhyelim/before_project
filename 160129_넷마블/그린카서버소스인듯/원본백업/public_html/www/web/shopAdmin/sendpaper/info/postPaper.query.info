-- 테이블 생성 --

CREATE TABLE `POST_PAPER` (
  `PP_NO` bigint(20) NOT NULL auto_increment COMMENT '번호',
  `PP_M_ID` varchar(20) default NULL COMMENT '보내는사람ID',
  `PP_TITLE` varchar(500) default NULL COMMENT '내용',
  `PP_TEXT` text COMMENT '내용',
  `PP_TOTAL_CNT` bigint(20) default NULL COMMENT '발송건수',
  `PP_REG_DT` datetime default NULL COMMENT '작성일',
  `PP_REG_NO` bigint(20) default NULL COMMENT '작성자',
  `PP_MOD_DT` datetime default NULL COMMENT '수정일',
  `PP_MOD_NO` bigint(20) default NULL COMMENT '수정자',
  PRIMARY KEY  (`PP_NO`)
) ENGINE=MyISAM AUTO_INCREMENT=12 DEFAULT CHARSET=utf8 COMMENT='전체쪽지발송관리';



-- 프로시저 --

DROP PROCEDURE IF EXISTS `SP_POST_PAPER_I`;
CREATE PROCEDURE `SP_POST_PAPER_I`(
	 IN IN_PP_NO INT
	,IN IN_PP_M_ID VARCHAR(20)
	,IN IN_PP_TITLE VARCHAR(500)
	,IN IN_PP_TEXT BLOB
	,IN IN_PP_TOTAL_CNT INT
	,IN IN_PP_REG_DT DATETIME
	,IN IN_PP_REG_NO INT
	,IN IN_PP_MOD_DT DATETIME
	,IN IN_PP_MOD_NO INT
)
BEGIN
	INSERT INTO POST_PAPER (
		 PP_M_ID
		,PP_TITLE
		,PP_TEXT
		,PP_TOTAL_CNT
		,PP_REG_DT
		,PP_REG_NO
		,PP_MOD_DT
		,PP_MOD_NO
	) VALUES (
		 IN_PP_M_ID
		,IN_PP_TITLE
		,IN_PP_TEXT
		,IN_PP_TOTAL_CNT
		,NOW()
		,IN_PP_REG_NO
		,NOW()
		,IN_PP_MOD_NO
	);
END

DROP PROCEDURE IF EXISTS `SP_POST_PAPER_U`;
CREATE PROCEDURE `SP_POST_PAPER_U`(
	 IN IN_PP_NO INT
	,IN IN_PP_M_ID VARCHAR(20)
	,IN IN_PP_TITLE VARCHAR(500)
	,IN IN_PP_TEXT BLOB
	,IN IN_PP_TOTAL_CNT INT
	,IN IN_PP_REG_DT DATETIME
	,IN IN_PP_REG_NO INT
	,IN IN_PP_MOD_DT DATETIME
	,IN IN_PP_MOD_NO INT
)
BEGIN
	UPDATE POST_PAPER SET 
		 PP_M_ID = IN_PP_M_ID
		,PP_TITLE = IN_PP_TITLE
		,PP_TEXT = IN_PP_TEXT
		,PP_TOTAL_CNT = IN_PP_TOTAL_CNT
		,PP_MOD_DT = NOW()
		,PP_MOD_NO = IN_PP_MOD_NO
	WHERE PP_NO = IN_PP_NO;
END


DROP PROCEDURE IF EXISTS `SP_POST_PAPER_D`;
CREATE PROCEDURE SP_POST_PAPER_D (
	 IN IN_PP_NO INT
)
BEGIN
	DELETE FROM POST_PAPER
	WHERE PP_NO = IN_PP_NO;
END;